description: "QakBot phishing campaign evades Windows Mark\u2011of\u2011the\u2011\
  Web by using a malformed JavaScript loader that injects a DLL into wermgr.exe and\
  \ communicates with C2 servers."
attribution: Unknown threat actor, QakBot
malware_families:
- QakBot
- ''
TTPs:
  processes:
  - wscript.exe
  - regsvr32.exe
  - wermgr.exe
  - powershell.exe
  - schtasks.exe
  - ping.exe
  - calc.exe
  commandline:
  - '''wscript.exe'' ''WW.js'''
  - '''regsvr32.exe'' ''/u'' ''port resemblance.tmp'''
  - 'powershell.exe -encodedCommand Microsoft.cnd /c set.ProfilelmagePath.SOFTWARE
    \\Microsoft\\WindowsNT\\CurrentVersion\\ProfileList.cnd.qwinsta.net share.Xs %84x.X%u
    %e4x.Xu res: %s seh_test: %uconsts_test: Xd vmdetected: %d createprocess: Xd.route
    print.whoami /all.powershell.exe -encodedCommand X5.regsvr32.exe .\"s\\system32\\schtasks.exe
    /Create /ST %62u:Xo2u /RU \"NTAUTHORITY\\SYSTEM\" /SC ONCE /tr \"%sTM /Z /ET %02u:%62u
    /tn %s.arp -3.3c91e539.netstat -nao.Startscreenshot..error re: .amstream.d11.schtasks.exe
    /Create /RU \"NTAUTHORITY\\SYSTEM\" /SC ONSTART /TN %u /TR \"%s\" /NP /F.net localgroup.
    /c ping.exe -n 6 127.0.0.1 &type \"s\\System32\\calc.exeTM > \"Xs.runas.ERROR:
    GetModuleFileNamew() failed with error:ERROR_INSUFFICIENT_BUFFER.Self check.'
  - 'schtasks.exe /Delete /F /TN %u.at.exe u:u "Xs" /I.powershell.exe -encodedCommandMicrosoft.cnd
    /c set.ProfilelmagePath.SOFTWARE \\Microsoft\\WindowsNT\\CurrentVersion\\ProfileList.cnd.qwinsta.net
    share.Xs %84x.X%u %e4x.Xu res: %s seh_test: %uconsts_test: Xd vmdetected: %d createprocess:
    Xd.route print.whoami /all.powershell.exe -encodedCommand X5.regsvr32.exe .\"s\\system32\\schtasks.exe
    /Create /ST %62u:Xo2u /RU \"NTAUTHORITY\\SYSTEM\" /SC ONCE /tr \"%sTM /Z /ET %02u:%62u
    /tn %s.arp -3.3c91e539.netstat -nao.Startscreenshot..error re: .amstream.d11.schtasks.exe
    /Create /RU \"NTAUTHORITY\\SYSTEM\" /SC ONSTART /TN %u /TR \"%s\" /NP /F.net localgroup.
    /c ping.exe -n 6 127.0.0.1 &type \"s\\System32\\calc.exeTM > \"Xs.runas.ERROR:
    GetModuleFileNamew() failed with error:ERROR_INSUFFICIENT_BUFFER.Self check.'
  powershell:
  - 'powershell.exe -encodedCommand Microsoft.cnd /c set.ProfilelmagePath.SOFTWARE
    \\Microsoft\\WindowsNT\\CurrentVersion\\ProfileList.cnd.qwinsta.net share.Xs %84x.X%u
    %e4x.Xu res: %s seh_test: %uconsts_test: Xd vmdetected: %d createprocess: Xd.route
    print.whoami /all.powershell.exe -encodedCommand X5.regsvr32.exe .\"s\\system32\\schtasks.exe
    /Create /ST %62u:Xo2u /RU \"NTAUTHORITY\\SYSTEM\" /SC ONCE /tr \"%sTM /Z /ET %02u:%62u
    /tn %s.arp -3.3c91e539.netstat -nao.Startscreenshot..error re: .amstream.d11.schtasks.exe
    /Create /RU \"NTAUTHORITY\\SYSTEM\" /SC ONSTART /TN %u /TR \"%s\" /NP /F.net localgroup.
    /c ping.exe -n 6 127.0.0.1 &type \"s\\System32\\calc.exeTM > \"Xs.runas.ERROR:
    GetModuleFileNamew() failed with error:ERROR_INSUFFICIENT_BUFFER.Self check.'
  scripting_engine:
  - JavaScript WW.js
  - 'regsvr32.exe .\"s\\system32\\schtasks.exe /Create /ST %62u:Xo2u /RU \"NTAUTHORITY\\SYSTEM\"
    /SC ONCE /tr \"%sTM /Z /ET %02u:%62u /tn %s.arp -3.3c91e539.netstat -nao.Startscreenshot..error
    re: .amstream.d11.schtasks.exe /Create /RU \"NTAUTHORITY\\SYSTEM\" /SC ONSTART
    /TN %u /TR \"%s\" /NP /F.net localgroup. /c ping.exe -n 6 127.0.0.1 &type \"s\\System32\\calc.exeTM
    > \"Xs.runas.ERROR: GetModuleFileNamew() failed with error:ERROR_INSUFFICIENT_BUFFER.Self
    check.'
  registry_keys:
  - SOFTWARE \\Microsoft\\Windows\\CurrentVersion\\Run
  - SOFTWARE \\Microsoft\\WindowsNT\\CurrentVersion\\ProfileList
  image_load:
  - process: wermgr.exe
    loaded_dll: resemblance.tmp
  - ''
  network_connections:
  - process: wscript.exe
    destination: <C2 server>
    protocol: HTTP POST
  - process: wermgr.exe
    destination: 192.0.2.123:443
    protocol: TCP
  - process: wermgr.exe
    destination: 83.114.60.171:2222
    protocol: TCP
  file_activity:
  - C:\\Users\\<user>\\Downloads\\resemblance.tmp
  - C:\\Users\\<user>\\Downloads\\UY76.img
  - C:\\Users\\<user>\\Downloads\\WW.js
  - C:\\Users\\<user>\\Downloads\\Injected-QakBot-dll
  - C:\\ProgranData\\Xs.runas
  persistence:
  - Scheduled Task via Schedule Task
  - Scheduled task creation via schtasks.exe
  - Run key modification in HKCU\Software\Microsoft\Windows\CurrentVersion\Run
  process_relations:
  - ''
IOCs:
  hashes:
  - 8ca16991684f7384c12b6622b8d1bcd23bc27f186f499c2059770ddd3031f274
  - 26f5bc698dfec8e771b781dc19941e2d657eb87fe8669e1f75d9e5a1bb4db1db
  - c5df8f8328103380943d8ead5345ca9fe8a9d495634db53cf9ea3266e353a3b1
  - 6fb41b33304b65e6e35f04e8cc70f7a24cd36e29bbb97266de68afcf113f9a5f
  ip_addresses:
  - 192.0.2.123
  - 83.114.60.171
  domains:
  - yahoo.com
  - google.com
  - cisco.com
  - oracle.com
  - verisign.com
  - broadcom.com
  - yahoo.con
  urls:
  - http://83.114.60.171:2222/t5
authors:
- EclecticIQ Intelligence & Research Team
reference: https://blog.eclecticiq.com/qakbot-malware-used-unpatched-vulnerability-to-bypass-windows-os-security-feature
date_of_publication: January 12, 2023
file_creation_date: September 16, 2025
